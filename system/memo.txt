手順メモ(※未整理)

1. kubernetes clusterの作成
  略

2. Istioのインストール
  helm_values_istio.yamlを編集(任意)
  ./install-istio.sh

3. gitlabの構築
  kubectl apply -f gitlab.yaml
  ブラウザからhttp://<your-server-ip>:30000にアクセス
  rootユーザ用のパスワードを設定し、ログイン
  (※必要であれば各ユーザを作成してください)

4. 各Projectの作成(ブラウザ上から操作)
  ProjFrontend
    初期ログイン後の画面からCreate a Projectを選択
    Project nameを入力(ProjFrontend)
    Visibility LevelをPublicに
    Create Projectボタンを押下
  ProjBackendとProjOps
    左上のGitlabアイコンをクリック
    右上のNew Projectボタンをクリック
    Project nameを入力(ProjBackend or ProjOps)
    Visibility LevelをPublicに
    Create Projectボタンを押下

5. gitlab-runnerの登録
  ProjFrontendの場合(※ProjBackendとProjOpsも同様に行う)
    gitlab-runner-setup.shの変数を修正
      gitlabUrl, gitlabPasswordとrunnerRegistrationToken(※)を自分のものに修正
      ※runnerRegistrationTokenはGitlabのダッシュボードの以下にある
        uunnerを登録したいProject -> Setting -> CICD -> Runners(Expandをクリック) -> Specific Runnersの中
    ./gitlab-runner-setup.sh

6. ソースコードを同期
  ProjFrontendの場合(※ProjBackendとProjOpsも同様に行う)
  ※注意点: gitのリポジトリのURLはWeb UI上にあるものではなく、アクセス可能なパス(http://<your-server-ip>:30000)を指定してください
    cd /path/to/jkd201812meetup/ProjFrontend/
    git init
    git add -A
    git commit -m "first version"
    git remote add origin http://<your-server-ip>:30000/root/projfrontend.git
    git push origin master

